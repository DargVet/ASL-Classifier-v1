from ultralytics import YOLO


def train():
    """
    –û–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å YOLO –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ —Ä—É–∫–∏ –Ω–∞ –∫–∞—Å—Ç–æ–º–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ.

    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
        None. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å –∏ –µ—ë ONNX –≤–µ—Ä—Å–∏—é.
    """

    print("üîç –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ YOLO11s...")

    # –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ YOLO11s (–º–∞–ª–∞—è –≤–µ—Ä—Å–∏—è)
    model = YOLO("yolo11s.pt")

    print("üöÄ –ù–∞—á–∞–ª–æ –æ–±—É—á–µ–Ω–∏—è...")

    # –ù–∞—á–∞–ª–æ –æ–±—É—á–µ–Ω–∏—è —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
    results = model.train(
        data="my_dataset_yolo/my_dataset_yolo.yaml",  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –¥–∞—Ç–∞—Å–µ—Ç–∞
        epochs=150,  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö –æ–±—É—á–µ–Ω–∏—è
        imgsz=640,  # –†–∞–∑–º–µ—Ä –≤—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (640x640 –ø–∏–∫—Å–µ–ª–µ–π)
        mosaic=0.4,  # –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–æ–∑–∞–∏—á–Ω–æ–π –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
        translate=0.15,  # –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏/—Å–º–µ—â–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        shear=7  # –°—Ç–µ–ø–µ–Ω—å —Å–¥–≤–∏–≥–∞ –¥–ª—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (–≤ –≥—Ä–∞–¥—É—Å–∞—Ö)
    )

    print("‚úÖ –û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")

    # –≠–∫—Å–ø–æ—Ä—Ç –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –≤ —Ñ–æ—Ä–º–∞—Ç ONNX –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
    model.export(
        format="onnx",  # –§–æ—Ä–º–∞—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞ (ONNX - Open Neural Network Exchange)
        imgsz=640,  # –†–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
        optimize=True  # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
    )

    print(" –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!")

if __name__ == '__main__':
    train()